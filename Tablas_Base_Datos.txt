-- Crear base de datos
CREATE DATABASE Estancia CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE Estancia;

-- Tabla: usuarios (familiares, admins)
CREATE TABLE usuarios (
    nip VARCHAR(10) NOT NULL PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    correo VARCHAR(100) NOT NULL UNIQUE,
    telefono VARCHAR(15),
    rol ENUM('familiar', 'admin') DEFAULT 'familiar'
);

CREATE TABLE pacientes (
    id_paciente INT AUTO_INCREMENT PRIMARY KEY,  -- Clave primaria para identificar de manera única a cada paciente
    nip VARCHAR(10) NOT NULL,  -- NIP del familiar
    nombre VARCHAR(100) NOT NULL,  -- Nombre del paciente
    telefono VARCHAR(15) DEFAULT NULL,  -- Teléfono del paciente
    condiciones TEXT DEFAULT NULL,  -- Condiciones médicas del paciente
    foto VARCHAR(255) DEFAULT NULL,  -- URL de la foto del paciente
    FOREIGN KEY (nip) REFERENCES usuarios(nip) ON DELETE CASCADE  -- Relación con la tabla usuarios, por el campo nip
);

-- Tabla: medicos
CREATE TABLE medicos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    especialidad VARCHAR(100) NOT NULL,
    correo VARCHAR(100),
    telefono VARCHAR(20)
);

-- Tabla: expedientes
CREATE TABLE expedientes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    paciente_nombre VARCHAR(100) NOT NULL,
    fecha_ultima_revision DATE,
    notas TEXT
);

-- Tabla: notificaciones médicas
CREATE TABLE notificaciones (
    id INT AUTO_INCREMENT PRIMARY KEY,
    titulo VARCHAR(100) NOT NULL,
    mensaje TEXT NOT NULL,
    fecha DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- Tabla: cuidadores
CREATE TABLE cuidadores (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    turno ENUM('mañana', 'tarde', 'noche') NOT NULL,
    contacto VARCHAR(100)
);

-- Tabla: cocina (menú diario)
CREATE TABLE cocina (
    id INT AUTO_INCREMENT PRIMARY KEY,
    fecha DATE NOT NULL,
    desayuno VARCHAR(255),
    comida VARCHAR(255),
    cena VARCHAR(255)
);

////
Usuario administrador de ejemplo (opcional)
INSERT INTO usuarios (nombre, correo, nip, rol)
VALUES ('Administrador', 'admin@uta.com', '1234', 'admin');
